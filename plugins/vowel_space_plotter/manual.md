# 元音空间图绘制器 - 使用手册

## 1. 插件用途

本插件能帮助您快速地将包含元音共振峰数据（Formant 1, Formant 2）的表格文件可视化，生成标准的元音空间图。
## 2. 核心功能

*   **多图层系统**: 您可以加载多组数据源作为独立的**图层**。每个图层都拥有自己独立的配置，可以在图表上轻松显示、隐藏或**强调**。
*   **音频联动播放**: **(新增!)** 为有关联`.TextGrid`的图层加载音频文件后，您可以通过**右键菜单或Enter键**直接播放`TextGrid`区间对应的音频片段，实现“所见即所听”的数据验证。
*   **智能工作流**: **(新增!)**
    *   **自动匹配TextGrid**: 加载数据文件时，插件会自动在项目标准目录 (`Results/analyze/textgrids/`) 下查找并关联同名的`.TextGrid`文件。
    *   **无缝数据导入**: 从“音频分析”模块发送数据时，关联的音频文件路径也会被一并传送，实现数据和音频的**一键加载**。
*   **动态交互模式**: **(新增!)**
    *   **选择即强调**: 在高效的“单选模式”下，单击`TextGrid`项即可在图表上**立即高亮**对应的数据点。
    *   **批量操作**: 在灵活的“多选模式”下，可使用`Ctrl/Shift`键选择多个`TextGrid`项，通过右键菜单进行**批量显示/隐藏/强调**。
*   **高度可定制的视觉样式**:
    *   **独立的图层配置**: 每个图层都可以独立设置F1/F2/分组列、颜色方案、数据点样式（大小、透明度、**形状**）以及统计可视化（平均值点、标准差椭圆）。
    *   **可配置的强调效果**: **(新增!)** 您可以全局配置“强调”的具体视觉效果，包括**放大比例、轮廓线宽和透明度变化**。
*   **灵活的导出与交互**:
    *   使用鼠标左键拖拽可平移图表，`Ctrl+滚轮`可进行缩放。
    *   鼠标悬停在数据点上会显示其详细信息。
    *   除了保存整个图表，您还可以**只保存单个图层**的渲染图片。

## 3. 界面详解

### 左侧面板：图层与分组控制器

这是您管理所有数据图层和其内部分组的核心区域。它由一个可拖动的分割条分为上下两部分。

#### 上方：图层列表

*   显示所有已添加的图层。图标表示其显示(✓)或隐藏(🚫)状态，以及是否被锁定(🔒)。
*   **双击图层**: 打开配置对话框，修改该图层的设置。
*   **右键单击图层**: 弹出菜单，提供显示/隐藏、锁定/解锁、重命名、配置、移除、合并和**保存单层图片**等操作。
*   **添加新图层...**: 打开配置对话框，添加新的数据图层。

#### 下方：分组/TextGrid项列表

*   此列表会**动态显示**在上方图层列表中**当前选中**的那个图层所包含的分组信息（通常来自`TextGrid`的标注）。
*   **显示复选框**: 控制该分组在图表上是否可见。
*   **强调图标**: ⭐ (`favorite`) 图标表示该分组当前处于“强调”状态。
*   **选择即强调 (复选框)**:
    *   **勾选 (默认)**: 启用“单选模式”。单击列表中的任意一项，该项会立即在图表中被强调。
    *   **取消勾选**: 启用“多选模式”。您可以使用`Ctrl/Shift`键选择多项，然后通过右键菜单进行批量操作。
*   **操作**:
    *   **右键单击**: 弹出菜单，提供对选中项的**批量显示/隐藏、批量强调/取消强调**操作，以及**播放音频片段**功能。
    *   **Enter键**: 播放当前选中项对应的音频片段（快捷键）。

### 中心区域：画布与数据预览

*   **图表画布**: 显示所有**已启用**图层的可视化结果。
*   **数据预览**: 显示在上方图层列表中**当前选中**的那个图层所加载的原始数据。

### 右侧面板：样式与分析设置

此面板分为两部分，提供全局和上下文相关的设置。

*   **全局设置**:
    *   **坐标轴与标题**: 设置图表标题、轴标签、轴范围和轴翻转。
    *   **强调样式 (新增!)**: 在这里配置全局的强调效果，包括放大比例、轮廓线宽和透明度变化。
*   *   **图层设置 (上下文敏感)**:
    *   **此区域只有在您选中左侧某个图层时才会启用。**
    *   它允许您为**当前选中的图层**进行详细的样式配置，包括数据点大小/透明度、**标记形状**（用于区分不同图层）、分组颜色以及统计可视化。

## 4. 核心工作流程 (音频联动分析示例)

1.  **准备文件**: 确保您的 `speaker_A.csv` 和 `speaker_A.TextGrid` 文件已准备好。将 `speaker_A.TextGrid` 放入项目 `Results/analyze/textgrids/` 目录下。
2.  **加载数据**: 在左侧面板，点击 **“添加新图层...”**。
3.  在弹出的**配置对话框**中：
    *   为图层命名，例如“说话人A”。
    *   点击“选择文件...”加载 `speaker_A.csv`。
    *   **插件会自动查找并加载** `speaker_A.TextGrid`！您会看到`TextGrid`文件名已自动填入。
    *   由于已关联`TextGrid`，“选择音频文件...”按钮会被启用。点击它，并加载对应的 `speaker_A.wav` 音频文件。
    *   点击“确定”。
4.  **交互分析**:
    *   在左侧下方的`TextGrid`项列表中，您会看到如 "a", "i", "u" 等标注。
    *   确保“选择即强调”已勾选。
    *   **单击**列表中的 "i"。您会看到图表中所有代表 /i/ 的数据点立即被放大并描边。
    *   **按下Enter键**，您会听到 `speaker_A.wav` 中被标注为 "i" 的那个**音频片段**。
5.  **对比分析**: 重复以上步骤，添加“说话人B”的图层。然后通过为不同图层设置不同的**标记形状**（如圆点 vs 方形），即可在同一图表上清晰地对比两者的元音分布。
6.  **固定视图**: 在您通过平移和缩放找到最佳观察视角后，点击左下角的 **“更新并固定数轴范围”** 按钮，即可锁定当前视图，方便后续添加更多图层进行对比。

## 5. 数据文件要求

-   您的数据文件应为标准的表格格式（Excel或CSV）。
-   必须包含至少两列**数值型**数据，分别代表 F1 和 F2。
-   **若要使用TextGrid和音频播放功能，数据文件中必须包含一列名为 `timestamp` 的时间戳列（单位：秒）。**
-   推荐包含一列用于分组的**标签列**（如元音符号），以便在没有`TextGrid`时也能进行分组。