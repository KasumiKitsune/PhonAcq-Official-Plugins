# 元音空间图绘制器 - 使用手册

## 1. 插件用途

本插件能帮助您快速地将包含元音共振峰数据（Formant 1, Formant 2）的表格文件（如 Excel 或 CSV）可视化，生成标准的元音空间图。这对于语音学和音系学研究中分析元音分布和变异至关重要。

## 2. 核心功能

*   **多数据源支持**: 可直接加载 `.xlsx`, `.xls`, 和 `.csv` 文件，或从主程序的“音频分析”模块接收数据。
*   **智能列识别**: 自动尝试根据列名（如 'f1', 'f2', 'vowel'）匹配 F1, F2 和分组标签。
*   **灵活的轴向设置**: 支持分别翻转 F1 (Y轴) 和 F2 (X轴) 以符合不同的学术绘图习惯（例如，F2 从右向左递增）。
*   **强大的分组与样式自定义**:
    *   可以根据指定的列（如元音标签 `[i, a, u]` 或说话人）对数据点进行分组。
    *   为每个分组独立设置**颜色**和**标记形状**（点、叉号、加号等）。
    *   提供多种预设的**颜色方案**，一键美化图表。
*   **统计可视化**:
    *   可为每个分组绘制一个代表其**平均F1/F2**值的点。
    *   可为每个分组绘制**标准差椭圆**，直观展示该组数据的分布范围和集中趋势。
*   **交互式图表**:
    *   **平移与缩放**: 使用鼠标左键拖拽可平移图表，`Ctrl+滚轮`可进行缩放。
    *   **悬浮提示**: 鼠标悬停在数据点上时，会显示该点的详细F1/F2值和所属分组。
*   **TextGrid联动**: 可加载Praat的 `.TextGrid` 文件，自动为数据点打上时间对应的标注标签，并以此进行分组。

## 3. 界面详解

### 左侧面板：数据加载与指定

*   **1. 数据源**:
    *   **加载数据文件**: 加载您的 Excel 或 CSV 数据。
    *   **加载 TextGrid**: **在加载数据文件之后**，加载一个 `.TextGrid` 文件，用于为数据点添加标注。
    *   **TG处理模式**: 选择如何处理多层的TextGrid文件。
*   **2. 数据列指定**:
    *   **F1 (Y轴) / F2 (X轴)**: 从下拉菜单中选择代表 F1 和 F2 共振峰数据的列。
    *   **分组依据**: 选择用于分组的列。加载TextGrid后，这里会出现一个 `textgrid_label` 选项。
*   **3. 绘图操作**:
    *   **更新图表**: 根据当前所有设置，重新绘制图表。

### 右侧面板：样式与分析设置

*   **全局样式**: 设置图表的标题和坐标轴标签。
*   **坐标轴**:
    *   **翻转X/Y轴**: 勾选以符合语音学绘图惯例。
    *   **X/Y轴范围**: 手动设置坐标轴的显示范围，留空则自动计算。
*   **数据点样式**: 在“无分组”模式下，设置所有数据点的颜色、大小和透明度。
*   **分组与图例**:
    *   当您选择了“分组依据”后，这里会**动态生成**每个分组的独立样式设置项。您可以为每个元音或说话人设置不同的颜色和标记形状。
    *   **颜色方案**: 一键将预设的色彩方案应用到所有分组。
*   **平均值点/标准差椭圆**: 勾选并展开，可以分别设置平均值点和椭圆的样式。

## 4. 核心工作流程

1.  **加载数据**: 点击左上角的 **“加载数据文件...”** 按钮，选择您的数据文件。加载成功后，文件名将显示，数据将在下方表格预览。
2.  **（可选）加载TextGrid**: 如果您的数据文件包含 `timestamp` 列，可以点击 **“加载 TextGrid...”** 按钮，选择一个对应的标注文件。插件会自动根据时间戳为每个数据点打上标签。
3.  **指定数据列**:
    *   在“数据列指定”区域，为 **F1 (Y轴)** 和 **F2 (X轴)** 选择正确的列。
    *   在 **“分组依据”** 下拉菜单中，选择您想用来区分数据点的列（例如包含元音符号 `[i, a, u]` 的列，或者 `textgrid_label` 列）。
4.  **自定义样式**:
    *   在右侧面板，根据需要修改图表标题、坐标轴等。
    *   如果已分组，可以在“分组与图例”区域为每个分组自定义颜色和标记。
    *   勾选并设置“平均值点”或“标准差椭圆”来增加统计信息。
5.  **生成图表**: 点击 **“更新图表”** 按钮。右侧的画布将显示生成的元音空间图。您可以随时修改选项并再次点击此按钮来更新图表。

## 5. 交互操作

*   **平移与缩放**: 使用鼠标在图表上拖拽和滚动，探索数据细节。
*   **获取数据点信息**: 将鼠标悬停在图表中的任意一个点上，会弹出一个提示框，显示该点的F1/F2值和所属分组。
*   **保存与分享**: 在图表上 **右键单击**，选择 **“保存图片...”** 或 **“复制图片”**，将您的分析结果导出。

## 6. 数据文件要求

-   您的数据文件应为标准的表格格式（Excel或CSV）。
-   必须包含至少两列**数值型**数据，分别代表 F1 和 F2。
-   推荐包含一列用于分组的**标签列**（如元音符号、说话人ID等）。
-   **若要使用TextGrid功能，数据文件中必须包含一列名为 `timestamp` 的时间戳列。**