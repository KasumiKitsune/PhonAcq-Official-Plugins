# 元音空间图绘制器 (多图层版) - 使用手册

## 1. 插件用途

本插件能帮助您快速地将包含元音共振峰数据（Formant 1, Formant 2）的表格文件（如 Excel 或 CSV）可视化，生成标准的元音空间图。新版本已升级为**多图层对比分析平台**，允许您在同一张图表上叠加、对比和独立配置多组数据源，是进行说话人对比、语境变异等语音学研究的强大工具。

## 2. 核心功能

*   **多图层系统**: 您可以加载多组“数据文件 + TextGrid”作为独立的**图层**。每个图层都拥有自己独立的配置，可以轻松地在图表上显示或隐藏。
*   **独立的图层配置**: 每个图层都可以独立设置其数据源、F1/F2/分组列、颜色方案、数据点样式（大小、透明度、标记形状）以及统计可视化（平均值点、标准差椭圆）。
*   **强大的样式区分**: 通过“**形状代表图层，颜色代表分组**”的策略，清晰地在视觉上区分不同来源（如图层A vs 图层B）和不同类别（如元音/a/ vs /i/）的数据。
*   **图层锁定**: 可以锁定已配置好的图层，防止误操作修改或删除。
*   **TextGrid联动**: 每个图层都可以关联一个独立的Praat `.TextGrid` 文件，自动为数据点打上时间对应的标注标签，并以此进行分组。
*   **高级图表交互**:
    *   **平移与缩放**: 使用鼠标左键拖拽可平移图表，`Ctrl+滚轮`可进行缩放。
    *   **悬浮提示**: 鼠标悬停在数据点上时，会显示该点的详细F1/F2值和所属的图层及分组。
*   **灵活的导出**: 除了保存整个图表，您还可以通过右键菜单**只保存单个图层**的渲染图片。

## 3. 界面详解

### 左侧面板：图层管理器

这里是您管理所有数据图层的核心区域。

*   **图层列表**:
    *   显示所有已添加的图层。
    *   图层前的图标表示其显示状态：✓ (`success`) 表示显示，🚫 (`hidden`) 表示隐藏。
    *   图层末尾的 🔒 (`lock`) 图标表示该图层已被锁定。
*   **操作**:
    *   **双击图层**: 打开配置对话框，修改该图层的设置。
    *   **右键单击图层**: 弹出上下文菜单，提供以下操作：
        *   **显示/隐藏图层**: 切换图层在图表上的可见性。
        *   **锁定/解锁图层**: 防止或允许对图层进行修改和删除。
        *   **重命名...**: 直接在表格中修改图层名称。
        *   **配置...**: 打开配置对话框，进行详细设置。
        *   **移除图层**: 删除选中的图层。
        *   **保存单层图片...**: 仅将当前图层的数据渲染并保存为图片。
*   **添加新图层...**: 点击此按钮打开配置对话框，以添加一个新的数据图层。
*   **更新图表**: 根据当前所有设置，重新绘制图表。

### 中心区域：画布与数据预览

*   **图表画布**: 显示所有**已启用**图层的可视化结果。
*   **数据预览**: 显示在左侧图层管理器中**当前选中**的那个图层所加载的原始数据。

### 右侧面板：样式与分析设置

此面板分为两部分，提供全局和上下文相关的设置。

*   **全局设置**:
    *   这些设置应用于整个图表，影响所有图层。
    *   包括图表标题、坐标轴标签、轴范围、轴翻转和是否显示图例。
*   **图层设置 (上下文敏感)**:
    *   **此区域只有在您选中左侧某个图层时才会启用。**
    *   它允许您为**当前选中的图层**进行详细的样式配置。
    *   **数据点样式**: 设置该图层数据点的大小和透明度。
    *   **图层样式**: 设置该图层的**标记形状**（圆点、方形等），用于在视觉上与其他图层区分。
    *   **分组样式**: 为该图层内的部分（如元音/a/, /i/）**分配颜色**。
    *   **平均值点 / 标准差椭圆**: 为该图层内的每个分组独立开启和配置统计可视化。

## 4. 核心工作流程 (对比分析示例)

1.  在左侧面板，点击 **“添加新图层...”**。
2.  在弹出的**配置对话框**中：
    *   命名图层为“说话人A”。
    *   加载 `speaker_A.csv` 和 `speaker_A.TextGrid`。
    *   插件会自动尝试匹配F1, F2列，并选择 `textgrid_label` 作为分组依据。您可以手动修改。
    *   选择一个“颜色方案”。点击“确定”。
3.  **重复第一步**，添加第二个图层，命名为“说话人B”，并加载其对应的数据和TextGrid文件。
4.  此时，左侧列表会显示两个图层。
5.  **选中“说话人A”图层**。右侧的“图层设置”面板会被激活。在“图层样式”中，为其选择**圆点**作为标记形状。
6.  **选中“说话人B”图层**。右侧面板会刷新。在“图层样式”中，为其选择**方形**作为标记形状。
7.  在“分组样式”区域，您可以为两个图层共有的元音（如/a/, /i/）设置颜色。例如，将/i/的颜色设为红色。
8.  点击 **“更新图表”**。
9.  最终图表上将会同时显示：
    *   来自“说话人A”的**红色圆点**（代表/i/）。
    *   来自“说话人B”的**红色方形**（代表/i/）。

## 5. 交互操作

*   **平移与缩放**: 使用鼠标在图表上拖拽和 `Ctrl+滚轮`，探索数据细节。
*   **获取数据点信息**: 将鼠标悬停在图表中的任意一个点上，会弹出一个提示框，显示该点的F1/F2值、所属图层和分组。
*   **保存与分享**: 在图表上 **右键单击**，选择 **“保存图片...”** 或 **“复制图片”**，将您看到的完整图表导出。

## 6. 数据文件要求

-   您的数据文件应为标准的表格格式（Excel或CSV）。
-   必须包含至少两列**数值型**数据，分别代表 F1 和 F2。
-   推荐包含一列用于分组的**标签列**（如元音符号、说话人ID等）。
-   **若要使用TextGrid功能，数据文件中必须包含一列名为 `timestamp` 的时间戳列。**