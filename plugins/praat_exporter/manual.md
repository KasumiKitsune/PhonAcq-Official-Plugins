# Praat TextGrid 导出器 - 使用手册

## 1. 插件用途

本插件是连接 **PhonAcq Assistant** 与业界标准语音分析软件 **Praat** 的桥梁。它提供了一个功能强大的**“标注工作台”**，允许您在 PhonAcq Assistant 中对音频进行多层（Tier）、多点（Interval）的精细标注，并一键将结果导出为 Praat 可以直接识别的 `.TextGrid` 标注文件，极大地提高了从观察到标注的研究效率。

---

## 2. 界面与功能详解

### **TextGrid 标注工作台**

当您在“音频分析”模块的右键菜单中选择“打开标注工作台”后，会弹出此窗口。

#### **左侧面板：分组与标注控制**

*   **分组 (对应 Tier)**:
    *   **分组列表**: 显示您创建的所有标注层（Tier）。每个分组都有一个颜色标记，便于区分。
    *   **添加/删除分组**: 您可以创建多个分组，例如 "音素层", "词语层", "备注层"。每个分组在导出的 TextGrid 文件中对应一个独立的 Tier。

*   **添加新标注**:
    *   **当前选区**: 显示您在主窗口“音频分析”语谱图上用鼠标拖拽出的时间范围。
    *   **标注文本**: 在此输入您要赋予该时间段的标注内容。
    *   **添加标注按钮**: 将当前选区和标注文本，添加到左侧选中的分组中。

#### **右侧面板：标注列表**

*   **已添加的标注**: 这里会列出当前选中分组下的所有标注条目，按时间顺序排列。
*   **交互**:
    *   **双击**: 任何一条标注，可以弹出一个对话框，精确地编辑其起始/结束时间戳和标注文本。
    *   **按 `Delete` 或 `Backspace` 键**: 删除当前选中的一条或多条标注。

#### **底部按钮**

*   **导入现有 TextGrid**: 选择一个已有的 `.TextGrid` 文件，将其中的所有标注层和标注信息加载到工作台中。**这会覆盖当前未保存的所有内容。**
*   **导出到 TextGrid**: 将当前工作台上的所有分组和标注，保存为一个新的 `.TextGrid` 文件。

---

## 3. 完整操作流程

1.  **启用插件**: 在“插件管理”中启用本插件。

2.  **进入分析模块**: 打开 `资源管理 -> 音频分析`，并加载一个音频文件。

3.  **打开工作台**:
    *   在语谱图上**右键单击**，从弹出的菜单中选择 **“打开标注工作台...”**。
    *   一个与当前音频关联的标注工作台窗口将会出现。

4.  **创建分组 (Tier)**:
    *   在工作台的左侧，点击“添加分组”按钮，输入一个有意义的名称，如 `vowels`。
    *   确保您想操作的分组在列表中是高亮选中的状态。

5.  **添加标注 (Interval)**:
    1.  回到主窗口的“音频分析”页面。
    2.  在语谱图上，用鼠标左键拖拽出一个您感兴趣的时间范围，例如一个元音的稳定段。
    3.  回到“标注工作台”窗口，您会看到“当前选区”的时间戳已自动更新。
    4.  在“标注文本”框中输入该元音的音标，例如 `a`。
    5.  点击“添加标注到选中分组”按钮。该标注会立刻出现在右侧的列表中。
    6.  重复此步骤，对音频进行完整标注。

6.  **（可选）处理重叠**:
    *   如果您添加的新标注与同一分组内的现有标注重叠，插件会弹窗提示。
    *   您可以选择**自动调整边界**（以重叠部分的中点为界分割），或取消本次添加。

7.  **导出结果**:
    *   完成所有标注后，点击工作台右下角的“导出到 TextGrid...”按钮。
    *   在弹出的对话框中，选择保存位置并命名。文件名会自动建议为与音频文件同名。

8.  **在 Praat 中验证**:
    *   打开 Praat，同时读入您的音频文件和刚刚导出的 `.TextGrid` 文件。
    *   点击 "View & Edit"，您应该能看到您在工作台中创建的所有标注层和标注段。

---

## 4. 提示

*   工作台窗口可以一直开着，您可以在主窗口和工作台之间来回切换，实时添加和修改标注。
*   导入 TextGrid 功能非常适合对已有的标注进行二次编辑和修正。
*   在导出时，插件会自动过滤掉时长过短（小于1ms）或文本为空的无效标注，确保生成高质量的 TextGrid 文件。