# 录音设备测试器 - 使用手册 (v3.0)

## 1. 插件用途

本插件是一个强大的**音频设备诊断与管理中心**，旨在解决在“程序设置”中仅凭设备名称难以判断其**可用性、工作状态和实际音质**的核心痛点。

它提供了一个集**实时监控、录制验证和持久化管理**于一体的可视化界面，让您能够自信地选择和配置最佳的录音设备。

---

## 2. 界面与功能详解

### 主界面

*   **设备列表**: 插件会自动扫描并列出您电脑上所有可用的麦克风和输入设备。每个设备项都包含：
    *   **状态图标**: 实时显示设备的当前状态（见下文详解）。
    *   **设备名称**: 显示设备的自定义名称（如果已设置）或原始名称。
    *   **详细信息**: 在名称下方以小字显示原始名称、设备索引和最大输入通道数。
    *   **实时音量条**: 一个动态的进度条，实时显示该设备的输入信号强度。

### 核心功能按钮

*   **开始/停止全部测试**:
    *   **作用**: 点击“开始全部测试”后，插件会**并行监听所有已启用的设备**。
    *   **用途**: 这是最快速的识别方法。对着您的麦克风说话，观察哪个设备的音量条在跳动，即可立即确定哪个是您想用的设备。
    *   **智能反馈**: 测试（最长5秒）结束后，插件会自动为设备标记**“检测到信号 (✅)”**或**“警告：未检测到信号 (⚠️)”**状态。

*   **录制3秒样本**:
    *   **作用**: 此功能**只针对当前在列表中选中的设备**。
    *   **用途**: 用于对特定设备进行**主观音质评估**。您可以录制一小段自己的声音，以判断其清晰度、底噪大小等。
    *   **智能验证**: 录制完成后，插件会自动分析录音。只有当录音中**包含有效声音信号**时，设备状态才会被更新为最终的**“已验证 (✔)”**。如果录到的是静音，状态会变为“警告：未检测到信号 (⚠️)”。

*   **回放样本**:
    *   在成功录制样本后，此按钮变为可用。点击即可试听刚刚录制的3秒音频。

*   **将此设为默认**:
    *   **作用**: 这是连接本插件与主程序设置的桥梁。
    *   **操作**: 当您通过测试找到了最满意的设备后，选中它，然后点击此按钮。
    *   **效果**: 插件会自动为您更新主程序的配置文件，将您的选择应用到所有的录音模块中。同时，它会自动将“程序设置”中的录音设备模式切换为**“专家模式”**，以确保您的精确选择生效。

---

## 3. 状态图标系统详解

每个设备名称前的图标代表了其当前的状态，帮助您快速做出判断：

*   **（无图标）**: **未测试** - 这是设备的初始状态。
*   **成功 (绿色对勾)**: **检测到信号** - 在“全部测试”中，此设备成功打开并检测到了有效的声音输入。
*   **警告 (黄色感叹号)**: **未检测到信号** - 设备已成功打开，但在测试期间没有检测到任何有效声音。请检查麦克风是否被静音或物理连接是否正常。
*   **错误 (红色叉)**: **设备错误** - 插件无法打开此设备。这通常意味着设备已被其他程序（如Teams, Discord, OBS）**独占使用**，或者其驱动程序存在兼容性问题。插件会自动将此类设备禁用。
*   **已验证 (蓝色验证章)**: **最高信任状态** - 您已通过“录制样本”并成功录入声音，亲自验证了此设备不仅可用，且音质符合您的要求。

---

## 4. 右键高级管理

在设备列表的任意设备上**右键单击**，可以打开一个高级管理菜单：

*   **开始/停止单独测试**: 对单个设备进行实时监听，而不影响其他设备。
*   **重命名...**: 为设备设置一个易于识别的**自定义名称**（例如“桌面USB麦克风”）。这个新名称也会同步显示在主程序的“程序设置”页面中。
*   **禁用/启用此设备**:
    *   **禁用**: 将设备从主程序的“程序设置”下拉列表中**隐藏**，避免在选择时造成干扰。被禁用的设备在测试器中会显示为灰色。
    *   **启用**: 重新在“程序设置”中显示该设备。

---

## 5. 推荐使用流程

1.  从主程序插件菜单中启动“录音设备测试器”。
2.  点击 **“开始全部测试”**，对着您的主麦克风说话，观察是哪个设备的音量条反应最灵敏。该设备的状态图标应变为 ✅。
3.  对于所有显示 ✅ 的设备，逐个**选中**它们。
4.  点击 **“录制3秒样本”**，然后点击 **“回放样本”**，试听音质。
5.  重复步骤4，直到找到音质最清晰、底噪最小的设备。该设备的状态图标会变为 ✔。
6.  选中这个最终设备，点击 **“将此设为默认”**。
7.  （可选）对于其他不想在设置中看到的设备，**右键**并选择**“禁用此设备”**。
8.  关闭测试器。您的音频设备现已完美配置。